
import os

from utils import shard
from check_completion import check 

all_wets = [u.strip().split("/")[-1] for u in open("outputs/wet.paths").readlines()]
completed = [0, 1, 2, 3, 4, 5, 6, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 169, 171, 172, 306, 307, 308, 310, 312, 313, 316, 320, 321, 324, 326, 328, 330, 331, 332, 333, 334, 336, 340, 341, 342, 345, 346, 347, 350, 352, 354, 356, 357, 358, 445, 447, 449, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 467, 468, 469, 472, 473, 474, 475, 476, 477, 479, 481, 482, 483, 484, 485, 487, 489, 492, 494, 496, 497, 498, 499, 500, 585, 586, 589, 592, 594, 596, 597, 602, 603, 604, 608, 609, 610, 611, 613, 614, 615, 616, 617, 618, 620, 624, 626, 627, 628, 639, 652, 662, 663, 725, 726, 729, 730, 733, 736, 737, 738, 744, 746, 748, 750, 752, 753, 754, 757, 758, 759, 760, 761, 762, 765, 766, 767, 772, 775, 777, 850, 851, 853, 854, 855, 857, 865, 866, 867, 868, 871, 872, 875, 876, 877, 879, 886, 887, 900, 901, 902, 903, 904, 905, 906, 907, 940, 941, 942, 943, 944, 945, 946, 947, 975, 976, 978, 980, 981, 982, 983, 984, 985, 986, 987, 989, 990, 991, 992, 995, 996, 998]
#check() 
num_shards = 1000

assert len(all_wets) == 72000

sharded_wets = shard(all_wets, num_shards)

for i in completed:
    for file in sharded_wets[i]:
        potential_file = "outputs/wet_dir/" + file
        if os.path.exists(potential_file):
            print(f"removing {potential_file} from completed shard {i}")
            os.remove(potential_file)

